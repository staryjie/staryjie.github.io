<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kubernetes面试题 | 运维小菜鸡</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="/css/style.css">
    <script charset="utf-8" src="/js/custom.js"></script>
    <meta name="description" content="欢迎来到这个小破站！">
    <meta name="keywords" content="运维小菜鸡,vuepress,自建博客,Golang,Linux,Kubernetes">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="robots" content="all">
    <meta name="author" content="StaryJie">
    
    <link rel="preload" href="/assets/css/0.styles.c986e881.css" as="style"><link rel="preload" href="/assets/js/app.d3fe0630.js" as="script"><link rel="preload" href="/assets/js/4.71650b81.js" as="script"><link rel="preload" href="/assets/js/1.2e0a1352.js" as="script"><link rel="preload" href="/assets/js/28.313b2b0d.js" as="script"><link rel="preload" href="/assets/js/10.4e913a6c.js" as="script"><link rel="prefetch" href="/assets/js/11.33ffef17.js"><link rel="prefetch" href="/assets/js/12.56728a12.js"><link rel="prefetch" href="/assets/js/13.8ef930ca.js"><link rel="prefetch" href="/assets/js/14.f4ee1855.js"><link rel="prefetch" href="/assets/js/15.201085a9.js"><link rel="prefetch" href="/assets/js/16.1016697a.js"><link rel="prefetch" href="/assets/js/17.3a38d145.js"><link rel="prefetch" href="/assets/js/18.d1c3af0d.js"><link rel="prefetch" href="/assets/js/19.b658fb39.js"><link rel="prefetch" href="/assets/js/20.69db32f9.js"><link rel="prefetch" href="/assets/js/21.e8fc8e0e.js"><link rel="prefetch" href="/assets/js/22.ef9c1ada.js"><link rel="prefetch" href="/assets/js/23.d2b73042.js"><link rel="prefetch" href="/assets/js/24.566f4d48.js"><link rel="prefetch" href="/assets/js/25.e09ddf46.js"><link rel="prefetch" href="/assets/js/26.e17524f0.js"><link rel="prefetch" href="/assets/js/27.d2b2ed3e.js"><link rel="prefetch" href="/assets/js/29.85bfe845.js"><link rel="prefetch" href="/assets/js/30.0e0a2769.js"><link rel="prefetch" href="/assets/js/31.71ee984c.js"><link rel="prefetch" href="/assets/js/5.49b56b2e.js"><link rel="prefetch" href="/assets/js/6.204f1d4a.js"><link rel="prefetch" href="/assets/js/7.edf336a6.js"><link rel="prefetch" href="/assets/js/8.bf849d55.js"><link rel="prefetch" href="/assets/js/9.b1f12dc7.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.dc37c295.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c986e881.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><div class="theme-container" data-v-4698c43e><div data-v-4698c43e><div id="loader-wrapper" class="loading-wrapper" data-v-1c4f0192 data-v-4698c43e data-v-4698c43e><div class="loader-main" data-v-1c4f0192><div data-v-1c4f0192></div><div data-v-1c4f0192></div><div data-v-1c4f0192></div><div data-v-1c4f0192></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-6cbeab0a data-v-4698c43e data-v-4698c43e><h3 class="title" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a>运维小菜鸡</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><input type="password" value="" data-v-6cbeab0a> <span data-v-6cbeab0a>Konck! Knock!</span> <button data-v-6cbeab0a>OK</button></label> <div class="footer" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><span data-v-6cbeab0a><i class="iconfont reco-theme" data-v-6cbeab0a></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-6cbeab0a>vuePress-theme-reco</a></span> <span data-v-6cbeab0a><i class="iconfont reco-copyright" data-v-6cbeab0a></i> <a data-v-6cbeab0a><span data-v-6cbeab0a>StaryJie</span>
            
          <span data-v-6cbeab0a>2022 - </span>
          2022
        </a></span></div></div> <div class="hide" data-v-4698c43e><header class="navbar" data-v-4698c43e><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">运维小菜鸡</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/guide/" class="nav-link"><i class="iconfont reco-eye"></i>
  本站指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      Golang
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Golang基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/golang/基础/introduce_golang.html" class="nav-link"><i class="iconfont undefined"></i>
  Go语言的发展和应用
</a></li><li class="dropdown-subitem"><a href="/golang/基础/install_golang.html" class="nav-link"><i class="iconfont undefined"></i>
  Go开发环境搭建
</a></li><li class="dropdown-subitem"><a href="/golang/基础/identify_keywords.html" class="nav-link"><i class="iconfont undefined"></i>
  标识符与关键字
</a></li><li class="dropdown-subitem"><a href="/golang/基础/operator_express.html" class="nav-link"><i class="iconfont undefined"></i>
  操作符与表达式
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      工具/IDE
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Visual Studio Code</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/tools/VsCode/kubernetes_linter.html" class="nav-link"><i class="iconfont undefined"></i>
  VsCode关闭Kubernetes中YAML的linter语法检查告警信息
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      Kubernetes
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Kubernetes</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/k8s/kubernetes/introduce_k8s.html" class="nav-link"><i class="iconfont undefined"></i>
  Kubernetes介绍
</a></li></ul></li><li class="dropdown-item"><h4>Helm</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/k8s/helm/introduce_helm.html" class="nav-link"><i class="iconfont undefined"></i>
  Helm介绍
</a></li></ul></li><li class="dropdown-item"><h4>Ingress</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/k8s/ingress/introduce_ingress.html" class="nav-link"><i class="iconfont undefined"></i>
  Ingress介绍
</a></li></ul></li><li class="dropdown-item"><h4>Istio</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/k8s/istio/introduce_istio.html" class="nav-link"><i class="iconfont undefined"></i>
  Istio介绍
</a></li></ul></li><li class="dropdown-item"><h4>Kubernetes面试题</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/k8s/面试题/interview_question.html" class="nav-link"><i class="iconfont undefined"></i>
  Kubernetes面试题
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-eye"></i>
      监控
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Prometheus</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/monitor/prometheus/introduce_prometheus.html" class="nav-link"><i class="iconfont undefined"></i>
  Prometheus介绍
</a></li></ul></li><li class="dropdown-item"><h4>Zabbix</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/monitor/zabbix/introduce_zabbix.html" class="nav-link"><i class="iconfont undefined"></i>
  Zabbix介绍
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-faq"></i>
      日常生活
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/daily/情感/say_sorry.html" class="nav-link"><i class="iconfont undefined"></i>
  情感
</a></li><li class="dropdown-item"><!----> <a href="/daily/烹饪/cooking.html" class="nav-link"><i class="iconfont undefined"></i>
  烹饪
</a></li><li class="dropdown-item"><!----> <a href="/daily/游戏/game.html" class="nav-link"><i class="iconfont undefined"></i>
  游戏
</a></li><li class="dropdown-item"><!----> <a href="/daily/旅行/travel.html" class="nav-link"><i class="iconfont undefined"></i>
  旅游
</a></li><li class="dropdown-item"><!----> <a href="/daily/宠物/pet.html" class="nav-link"><i class="iconfont undefined"></i>
  宠物
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-blog"></i>
      博客
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.cnblogs.com/jie-fang" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-blog"></i>
  博客园
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-4698c43e></div> <aside class="sidebar" data-v-4698c43e><div class="personal-info-wrapper" data-v-6c8ffc9c><img src="/avatar.png" alt="author-avatar" class="personal-img" data-v-6c8ffc9c> <h3 class="name" data-v-6c8ffc9c>
    StaryJie
  </h3> <div class="num" data-v-6c8ffc9c><div data-v-6c8ffc9c><h3 data-v-6c8ffc9c>10</h3> <h6 data-v-6c8ffc9c>文章</h6></div> <div data-v-6c8ffc9c><h3 data-v-6c8ffc9c>10</h3> <h6 data-v-6c8ffc9c>标签</h6></div></div> <hr data-v-6c8ffc9c></div> <nav class="nav-links"><div class="nav-item"><a href="/guide/" class="nav-link"><i class="iconfont reco-eye"></i>
  本站指南
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      Golang
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Golang基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/golang/基础/introduce_golang.html" class="nav-link"><i class="iconfont undefined"></i>
  Go语言的发展和应用
</a></li><li class="dropdown-subitem"><a href="/golang/基础/install_golang.html" class="nav-link"><i class="iconfont undefined"></i>
  Go开发环境搭建
</a></li><li class="dropdown-subitem"><a href="/golang/基础/identify_keywords.html" class="nav-link"><i class="iconfont undefined"></i>
  标识符与关键字
</a></li><li class="dropdown-subitem"><a href="/golang/基础/operator_express.html" class="nav-link"><i class="iconfont undefined"></i>
  操作符与表达式
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      工具/IDE
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Visual Studio Code</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/tools/VsCode/kubernetes_linter.html" class="nav-link"><i class="iconfont undefined"></i>
  VsCode关闭Kubernetes中YAML的linter语法检查告警信息
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-api"></i>
      Kubernetes
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Kubernetes</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/k8s/kubernetes/introduce_k8s.html" class="nav-link"><i class="iconfont undefined"></i>
  Kubernetes介绍
</a></li></ul></li><li class="dropdown-item"><h4>Helm</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/k8s/helm/introduce_helm.html" class="nav-link"><i class="iconfont undefined"></i>
  Helm介绍
</a></li></ul></li><li class="dropdown-item"><h4>Ingress</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/k8s/ingress/introduce_ingress.html" class="nav-link"><i class="iconfont undefined"></i>
  Ingress介绍
</a></li></ul></li><li class="dropdown-item"><h4>Istio</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/k8s/istio/introduce_istio.html" class="nav-link"><i class="iconfont undefined"></i>
  Istio介绍
</a></li></ul></li><li class="dropdown-item"><h4>Kubernetes面试题</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/k8s/面试题/interview_question.html" class="nav-link"><i class="iconfont undefined"></i>
  Kubernetes面试题
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-eye"></i>
      监控
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Prometheus</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/monitor/prometheus/introduce_prometheus.html" class="nav-link"><i class="iconfont undefined"></i>
  Prometheus介绍
</a></li></ul></li><li class="dropdown-item"><h4>Zabbix</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/monitor/zabbix/introduce_zabbix.html" class="nav-link"><i class="iconfont undefined"></i>
  Zabbix介绍
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-faq"></i>
      日常生活
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/daily/情感/say_sorry.html" class="nav-link"><i class="iconfont undefined"></i>
  情感
</a></li><li class="dropdown-item"><!----> <a href="/daily/烹饪/cooking.html" class="nav-link"><i class="iconfont undefined"></i>
  烹饪
</a></li><li class="dropdown-item"><!----> <a href="/daily/游戏/game.html" class="nav-link"><i class="iconfont undefined"></i>
  游戏
</a></li><li class="dropdown-item"><!----> <a href="/daily/旅行/travel.html" class="nav-link"><i class="iconfont undefined"></i>
  旅游
</a></li><li class="dropdown-item"><!----> <a href="/daily/宠物/pet.html" class="nav-link"><i class="iconfont undefined"></i>
  宠物
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-blog"></i>
      博客
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://www.cnblogs.com/jie-fang" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-blog"></i>
  博客园
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>面试题</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/k8s/面试题/interview_question.html" class="active sidebar-link">Kubernetes面试题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/k8s/面试题/interview_question.html#_1、docker与虚拟机有什么不同" class="sidebar-link">1、Docker与虚拟机有什么不同？</a></li><li class="sidebar-sub-header"><a href="/k8s/面试题/interview_question.html#_2、简述kubernetes与docker的关系" class="sidebar-link">2、简述Kubernetes与Docker的关系？</a></li><li class="sidebar-sub-header"><a href="/k8s/面试题/interview_question.html#_3、kube-proxy采用ipvs和iptables的区别" class="sidebar-link">3、kube-proxy采用ipvs和iptables的区别？</a></li><li class="sidebar-sub-header"><a href="/k8s/面试题/interview_question.html#_4、简述kube-proxy切换为ipvs负载" class="sidebar-link">4、简述kube-proxy切换为ipvs负载</a></li><li class="sidebar-sub-header"><a href="/k8s/面试题/interview_question.html#_5、简述微服务部署中的蓝绿发布" class="sidebar-link">5、简述微服务部署中的蓝绿发布</a></li><li class="sidebar-sub-header"><a href="/k8s/面试题/interview_question.html#_6、简述蓝绿发布的特点" class="sidebar-link">6、简述蓝绿发布的特点</a></li><li class="sidebar-sub-header"><a href="/k8s/面试题/interview_question.html#_7、简述kubernetes静态pod" class="sidebar-link">7、简述Kubernetes静态Pod</a></li><li class="sidebar-sub-header"><a href="/k8s/面试题/interview_question.html#_8、简述kubernetes数据持久化的方式有哪些" class="sidebar-link">8、简述Kubernetes数据持久化的方式有哪些？</a></li><li class="sidebar-sub-header"><a href="/k8s/面试题/interview_question.html#_9、简述dockerfile中copy和add指令有啥区别" class="sidebar-link">9、简述Dockerfile中COPY和ADD指令有啥区别</a></li><li class="sidebar-sub-header"><a href="/k8s/面试题/interview_question.html#_10、如何为kubernetes集群删除或者添加新的节点" class="sidebar-link">10、如何为Kubernetes集群删除或者添加新的节点</a></li></ul></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-6cbeab0a data-v-4698c43e><h3 class="title" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a>Kubernetes面试题</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><input type="password" value="" data-v-6cbeab0a> <span data-v-6cbeab0a>Konck! Knock!</span> <button data-v-6cbeab0a>OK</button></label> <div class="footer" style="display:none;" data-v-6cbeab0a data-v-6cbeab0a><span data-v-6cbeab0a><i class="iconfont reco-theme" data-v-6cbeab0a></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-6cbeab0a>vuePress-theme-reco</a></span> <span data-v-6cbeab0a><i class="iconfont reco-copyright" data-v-6cbeab0a></i> <a data-v-6cbeab0a><span data-v-6cbeab0a>StaryJie</span>
            
          <span data-v-6cbeab0a>2022 - </span>
          2022
        </a></span></div></div> <div data-v-4698c43e><main class="page"><!----> <div class="page-title" style="display:none;"><h1>Kubernetes面试题</h1> <hr> <div data-v-484a899e><i class="iconfont reco-account" data-v-484a899e><span data-v-484a899e>StaryJie</span></i> <i class="iconfont reco-date" data-v-484a899e><span data-v-484a899e>2022-09-23 11:25:43</span></i> <!----> <i class="iconfont reco-tag tags" data-v-484a899e><span class="tag-item" data-v-484a899e>
      Kubernetes
    </span><span class="tag-item" data-v-484a899e>
      k8s
    </span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><div class="custom-block tip"><p class="custom-block-title">说明</p> <p>Kubernetes面试题</p></div> <h1 id="kubernetes面试题"><a href="#kubernetes面试题" class="header-anchor">#</a> Kubernetes面试题</h1> <h2 id="_1、docker与虚拟机有什么不同"><a href="#_1、docker与虚拟机有什么不同" class="header-anchor">#</a> 1、Docker与虚拟机有什么不同？</h2> <p><img src="http://static.staryjie.com/static/images/2022-09-16_08-59-17-275.png" alt=""></p> <ul><li><p>Docker是轻量级的沙盒，在其中运行的只是应用，资源使用率较低</p></li> <li><p>虚拟机中还有额外独立操作系统运行</p></li> <li><p>Docker<code>资源利用率更高</code></p> <p>台物理机可以运行数百个容器，但是一般只能运行数十个虚拟机。</p></li> <li><p>Docker<code>开销更小</code></p> <p>不需要启动单独的虚拟机占用硬件资源。</p></li> <li><p>Docker<code>启动速度更快</code></p> <p>可以在数秒内完成启动。</p></li></ul> <p><img src="http://static.staryjie.com/static/images/20210131111656.png" alt=""></p> <p>使用虚拟机是为了更好的实现服务运行环境隔离，每个虚拟机都有独立的内核，虚拟化可以实现不同操作系统的虚拟机，但是通常一个虚拟机只运行一个服务，很明显资源使用率比较低且造成不必要的性能损耗，我们创建虚拟机的目的是为了运行应用程序，比如Nginx、PHP、TomCat等web程序，使用虚拟机无疑带来了一些不必要的资源开销，但是容器技术则基于减少中间运行环节带来了较大的性能提升。</p> <h2 id="_2、简述kubernetes与docker的关系"><a href="#_2、简述kubernetes与docker的关系" class="header-anchor">#</a> 2、简述Kubernetes与Docker的关系？</h2> <ul><li><p>Docker通过Dockerfile将应用程序运行所需要的设置和依赖打包到一个镜像中，从而实现了可移植的特性。</p></li> <li><p>Kubernetes用于关联和编排在多个主机上运行的容器。</p></li> <li><p>Docker作为Kubernetes的CRI ( Container Runtime Interface) 实现之一，但是Kubernetes的CRI并非只有Docker。</p></li></ul> <h2 id="_3、kube-proxy采用ipvs和iptables的区别"><a href="#_3、kube-proxy采用ipvs和iptables的区别" class="header-anchor">#</a> 3、kube-proxy采用ipvs和iptables的区别？</h2> <p>iptables是为防火墙而设计的；</p> <p>ipvs则是专门用于高性能负载均衡，并使用更高效的数据结构（Hash表），允许无限的规模扩张。</p> <p>相同之处：</p> <ul><li>ipvs和iptables都是基于netfilter内核模块转发流量的。</li></ul> <p>与iptables相比，ipvs有以下明显优势：</p> <ul><li>为大型集群提供了更好的可扩展性和性能</li> <li>支持比iptables更复杂的负载均衡算法（最小负载、最少连接、加权等等）</li> <li>支持服务器监控检查和连接重试等功能</li> <li>可以动态修改ipset的集合</li></ul> <p>iptables:</p> <p>优点：</p> <ul><li>灵活</li> <li>功能强大（对TCP不同阶段的包进行操作）</li></ul> <p>缺点：</p> <ul><li>表中规则较多时，查询缓慢，影响性能</li></ul> <p>ipvs</p> <p>优点：</p> <ul><li>转发效率高</li> <li>调度算法丰富： rr, wrr, lc, wlc, ip_hash ...</li></ul> <p>缺点：</p> <ul><li>低版本内核支持不全，需要升级内核版本</li></ul> <blockquote><p>扩展：Kubernetes还有哪些代理模式？</p> <ul><li>UserSpace：Kubernetes早期版本使用</li> <li>KernelSpace：专用于Windows</li> <li>iptables</li> <li>ipvs</li></ul></blockquote> <h2 id="_4、简述kube-proxy切换为ipvs负载"><a href="#_4、简述kube-proxy切换为ipvs负载" class="header-anchor">#</a> 4、简述kube-proxy切换为ipvs负载</h2> <p>Kubernetes默认的kube-proxy模式是使用iptables的，但是iptables的性能在大规模集群中会变得很差，而且有时候会出现一些问题，比如 clusterip 不能 ping 通。所以一般在安装Kubernetes的时候会将 kube-proxy 模式切换为 ipvs。</p> <p>大致步骤如下：</p> <ol><li><p>查看kube-proxy信息</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubectl get pods <span class="token parameter variable">-n</span> kube-system <span class="token parameter variable">-o</span> wide <span class="token operator">|</span> <span class="token function">grep</span> proxy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>使用kubectl logs可以查看当前kube-proxy的proxy模式</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubectl logs <span class="token parameter variable">-n</span> kube-system kube-proxy-6kwzc

I0923 00:08:06.511166       <span class="token number">1</span> node.go:172<span class="token punctuation">]</span> Successfully retrieved <span class="token function">node</span> IP: <span class="token number">192.168</span>.126.20
I0923 00:08:06.511240       <span class="token number">1</span> server_others.go:142<span class="token punctuation">]</span> kube-proxy <span class="token function">node</span> IP is an IPv4 address <span class="token punctuation">(</span><span class="token number">192.168</span>.126.20<span class="token punctuation">)</span>, assume IPv4 operation
W0923 00:08:06.915071       <span class="token number">1</span> server_others.go:578<span class="token punctuation">]</span> Unknown proxy mode <span class="token string">&quot;&quot;</span>, assuming iptables proxy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>Unknown proxy mode &quot;&quot;, assuming iptables proxy，默认情况下就是<code>iptables</code>代理模式。</p></blockquote></li> <li><p>所有节点启用ipvs模块</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">&gt;</span> /etc/sysconfig/modules/ipvs.modules</span>
#!/bin/bash
ipvs_modules=&quot;/usr/lib/modules/\<span class="token variable"><span class="token variable">`</span><span class="token function">uname</span> -r<span class="token punctuation">\</span><span class="token variable">`</span></span>/kernel/net/netfilter/ipvs/&quot;
echo \<span class="token variable">$ipvs_modules</span>
for kernel_module in \<span class="token variable"><span class="token variable">`</span><span class="token function">ls</span> <span class="token punctuation">\</span>$ipvs_modules <span class="token operator">|</span> <span class="token function">sed</span> <span class="token parameter variable">-r</span> <span class="token string">'s#(.*).ko.xz#\1#'</span><span class="token punctuation">\</span><span class="token variable">`</span></span>; do
  /sbin/modinfo -F filename \<span class="token variable">${kernel_module}</span> &gt; /dev/null 2&gt;&amp;1
  if [ 0 -eq 0 ]; then
    /sbin/modprobe \<span class="token variable">${kernel_module}</span>
  fi
done
EOF</span>

<span class="token comment"># 给予可执行权限</span>
<span class="token function">chmod</span> +x /etc/sysconfig/modules/ipvs.modules
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li> <li><p>确保所有节点的ipvs模块以及成功运行</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>lsmod <span class="token operator">|</span> <span class="token function">grep</span> ip_vs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>修改kube-proxy的配置文件</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubectl edit configmaps kube-proxy <span class="token parameter variable">-n</span> kube-system

<span class="token comment"># 将 mode: &quot;&quot;，修改为 mode: &quot;ipvs&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>删除旧的Pod</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubectl delete pods <span class="token parameter variable">-n</span> kube-system <span class="token variable"><span class="token variable">$(</span>kubectl get pods <span class="token parameter variable">-n</span> kube-system <span class="token operator">|</span> <span class="token function">grep</span> <span class="token parameter variable">-v</span> <span class="token function">grep</span><span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&quot;kube-proxy&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $1}'</span><span class="token variable">)</span></span>

<span class="token comment"># 或者使用下面的命令</span>
kubectl delete pods <span class="token parameter variable">-l</span> k8s-app<span class="token operator">=</span>kube-proxy <span class="token parameter variable">-n</span> kube-system

<span class="token comment"># 确保新的kube-proxy的Pod正常启动运行</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>查看ipvs模式是否生效</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubectl logs <span class="token parameter variable">-n</span> kube-system kube-proxy-7thk6

yum <span class="token function">install</span> ipvsadm

ipvsadm <span class="token parameter variable">-L</span> <span class="token parameter variable">-n</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ol> <h2 id="_5、简述微服务部署中的蓝绿发布"><a href="#_5、简述微服务部署中的蓝绿发布" class="header-anchor">#</a> 5、简述微服务部署中的蓝绿发布</h2> <p>蓝绿发布（Blue/Green Deployment）</p> <p>蓝绿部署中，一共有两套系统：</p> <ul><li>正在线上提供服务的系统，标记为<font style="color:green;">绿色</font></li> <li>准备发布的新版本，标记为<font style="color:blue;">蓝色</font></li></ul> <p>两套系统都是功能完善的、正在运行的系统，只是系统版本和对外提供的服务不同。</p> <p>开发新版本，需要使用新版本替换线上的旧版本，在线上的旧系统之外，搭建一个使用新版本代码的系统。这时候，一共有两套系统正在运行，正在对外提供服务的旧版本是绿色系统，新部署的是蓝色系统。</p> <p>蓝色系统不对外提供服务，用来做发布前的测试，测试过程中有任何问题，都可以直接在蓝色系统中直接修改，不干扰用户正在使用的绿色系统。</p> <p>蓝色系统经过反复的测试、修改、验证，确定达到上线标准之后，直接将用户流量切换到蓝色系统。确定没有问题之后，绿色系统就可以停机下线。</p> <h2 id="_6、简述蓝绿发布的特点"><a href="#_6、简述蓝绿发布的特点" class="header-anchor">#</a> 6、简述蓝绿发布的特点</h2> <p>蓝绿部署无需停机，并且风险最小</p> <p>蓝绿发布的优势</p> <ul><li>升级、切换和回退速度非常快</li></ul> <p>不足：</p> <ul><li>全量切换需要两倍的机器资源</li></ul> <h3 id="演示"><a href="#演示" class="header-anchor">#</a> 演示</h3> <p><code>green.yaml</code></p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> demoapp<span class="token punctuation">-</span>v1
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> demoapp<span class="token punctuation">-</span>v1
      <span class="token key atrule">version</span><span class="token punctuation">:</span> v1
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> demoapp<span class="token punctuation">-</span>v1
        <span class="token key atrule">version</span><span class="token punctuation">:</span> v1
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> demoapp<span class="token punctuation">-</span>v1
          <span class="token key atrule">image</span><span class="token punctuation">:</span> ikubernetes/demoapp<span class="token punctuation">:</span>v1.0
          <span class="token key atrule">resources</span><span class="token punctuation">:</span>
            <span class="token key atrule">limits</span><span class="token punctuation">:</span>
              <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token string">&quot;128Mi&quot;</span>
              <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">&quot;500m&quot;</span>
          <span class="token key atrule">ports</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> demoapp<span class="token punctuation">-</span>visit<span class="token punctuation">-</span>svc
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> NodePort
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> demoapp<span class="token punctuation">-</span>v1
    <span class="token key atrule">version</span><span class="token punctuation">:</span> v1
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> http
      <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
      <span class="token key atrule">nodePort</span><span class="token punctuation">:</span> <span class="token number">31980</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><p>浏览器访问：<img src="http://static.staryjie.com/static/images/20220923093636.png" alt=""></p> <p>此时需要更新版本：</p> <p><code>blue.yaml</code></p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> demoapp<span class="token punctuation">-</span>v2
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> demoapp<span class="token punctuation">-</span>v2
      <span class="token key atrule">version</span><span class="token punctuation">:</span> v2
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> demoapp<span class="token punctuation">-</span>v2
        <span class="token key atrule">version</span><span class="token punctuation">:</span> v2
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> demoapp<span class="token punctuation">-</span>v2
          <span class="token key atrule">image</span><span class="token punctuation">:</span> ikubernetes/demoapp<span class="token punctuation">:</span>v1.1
          <span class="token key atrule">resources</span><span class="token punctuation">:</span>
            <span class="token key atrule">limits</span><span class="token punctuation">:</span>
              <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token string">&quot;128Mi&quot;</span>
              <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">&quot;500m&quot;</span>
          <span class="token key atrule">ports</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubectl apply <span class="token parameter variable">-f</span> blue.yaml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>部署完bule版本，并且测试通过之后，需要进行版本切换：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubectl edit svc demoapp-visit-svc

<span class="token comment"># 将 app: demoapp-v1 修改为 app: demoapp-v2</span>
<span class="token comment"># 将 version: v1 修改为 version: v2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>修改完成保存退出，访问的流量马上就发生了变化：<img src="http://static.staryjie.com/static/images/2022-09-23_09-50-31-298.png" alt=""></p> <h2 id="_7、简述kubernetes静态pod"><a href="#_7、简述kubernetes静态pod" class="header-anchor">#</a> 7、简述Kubernetes静态Pod</h2> <ul><li>由Kubelet创建，并且总是在kubelet所在的节点上运行。</li> <li>静态Pod的配置文件路径
<ul><li>kubeadm安装的：<code>/var/lib/kubelet/config.yaml</code>，其中<code>staticPodPath: /etc/kubernetes/manifests</code></li> <li>二进制安装的：需要在<code>/usr/li/systemd/system/kubelet.service</code>文件中添加一行<code>--pod-manifest-path=&lt;dir&gt;</code>指定</li></ul></li></ul> <p>如果要创建自己的静态Pod，只需要在对应的配置文件路径下创建自己的配置文件即可。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">&gt;</span>/etc/kubernetes/manifests/static-web.yaml</span>
apiVersion: v1
kind: Pod
metadata:
  name: static-web
  labels:
    role: myrole
spec:
  containers:
    - name: static-web
      image: nginx:1.17.1
      ports:
        - name: web
          protocol: TCP
          containerPort: 80
EOF</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>此时，无需任何操作，kubelet会自动创建该Pod。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubectl get pods <span class="token parameter variable">-A</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>停止或者删除静态Pod的方式：</p> <ul><li>删除<code>/etc/kubernetes/manifests/static-web.yaml</code>文件</li></ul> <p>其他方式删除或者停止Pod都会被kubelet自动创建。</p> <h2 id="_8、简述kubernetes数据持久化的方式有哪些"><a href="#_8、简述kubernetes数据持久化的方式有哪些" class="header-anchor">#</a> 8、简述Kubernetes数据持久化的方式有哪些？</h2> <ul><li>emptyDir：空目录  临时存储</li> <li>hostPath：挂载宿主机目录</li> <li>pv存储：NFS、glusterfs、ceph ......</li></ul> <h2 id="_9、简述dockerfile中copy和add指令有啥区别"><a href="#_9、简述dockerfile中copy和add指令有啥区别" class="header-anchor">#</a> 9、简述Dockerfile中COPY和ADD指令有啥区别</h2> <ul><li>COPY
<ul><li>文件复制，将宿主机的文件复制到容器内</li></ul></li> <li>ADD
<ul><li>文件复制，将宿主机的文件复制到容器内</li> <li>支持文件解压缩</li> <li>支持URL</li></ul></li></ul> <h2 id="_10、如何为kubernetes集群删除或者添加新的节点"><a href="#_10、如何为kubernetes集群删除或者添加新的节点" class="header-anchor">#</a> 10、如何为Kubernetes集群删除或者添加新的节点</h2> <h3 id="_10-1-删除节点"><a href="#_10-1-删除节点" class="header-anchor">#</a> 10.1 删除节点</h3> <p>首先确认节点是否故障不能开机，如果不能开机需要维修的，直接在master节点上删除该节点就可以：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubectl delete nodes k8s-node03
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果节点仍在正常运行并且运行着Pod，那么首先需要将节点上的Pod进行驱逐：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 方法1：在节点上打上污点即可驱逐大部分业务Pod</span>
kubectl taint <span class="token function">node</span> k8s-node03 node-type<span class="token operator">=</span>production:NoExecute

<span class="token comment"># 方法2：通过kubectl drain将指定节点上的资源迁移至集群中其他节点</span>
kubectl drain k8s-node03 --delete-emptydir-data <span class="token parameter variable">--force</span> --ignore-daemonsets
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>污点排斥等级排序：<code>NoExecute</code>&gt; <code>NoSchedule</code> &gt; <code>PreferNoSchedule</code></p></blockquote> <p>然后删除节点：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>kubectl get nodes <span class="token parameter variable">-o</span> wide

kubectl delete nodes k8s-node03
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>确认Pod驱逐完成之后，将节点重置，并清除数据：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 在你需要删除的节点上执行</span>
kubeadm reset <span class="token parameter variable">-f</span>

systemctl stop kubelet.service
systemctl stop docker.service

<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/cni/
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/kubelet/*
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> /etc/cni/

<span class="token function">ifconfig</span> cni0 down
<span class="token function">ifconfig</span> flannel.1 down
<span class="token function">ifconfig</span> docker0 down
<span class="token function">ip</span> <span class="token function">link</span> delete cni0
<span class="token function">ip</span> <span class="token function">link</span> delete flannel.1

system start docker.service

iptables <span class="token parameter variable">-F</span>
iptables <span class="token parameter variable">-t</span> nat <span class="token parameter variable">-F</span>
iptables <span class="token parameter variable">-t</span> mangle <span class="token parameter variable">-F</span>
iptables <span class="token parameter variable">-X</span>
ipvsadm <span class="token parameter variable">-C</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h3 id="_10-2-添加新的节点"><a href="#_10-2-添加新的节点" class="header-anchor">#</a> 10.2 添加新的节点</h3> <p>需要在需要加入的节点上做好环境准备工作，必须一些必须的Kubernetes组件的安装等等。</p> <p>如果是<code>kubeadm</code>安装的节点，需要查看加入集群的token是否失效：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 查看token的名称</span>
kubeadm token list

<span class="token comment"># 查看token的值</span>
openssl x509 <span class="token parameter variable">-pubkey</span> <span class="token parameter variable">-in</span> /etc/kubernetes/pki/ca.crt <span class="token operator">|</span> openssl rsa <span class="token parameter variable">-pubin</span> <span class="token parameter variable">-outform</span> der <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span>/dev/null <span class="token operator">|</span> openssl dgst <span class="token parameter variable">-sha256</span> <span class="token parameter variable">-hex</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/^.* //'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>如果Token失效了，那么就需要通过<code>kubeadm</code>目录重新生成Token：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 生成临时的Token，有效期24小时</span>
kubeadm token create --print-join-command

<span class="token comment"># 生成永久的Token</span>
kubeadm token create --print-join-command <span class="token parameter variable">--ttl</span> <span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>然后根据要将该节点加入到工作节点还是控制节点，执行不同的命令加入集群：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 加入控制节点</span>
kubeadm <span class="token function">join</span> <span class="token number">192.168</span>.126.10:6443 <span class="token parameter variable">--token</span> mhls2v.xqoxslpkzj89l9bc     --discovery-token-ca-cert-hash sha256:7207de86a81efadf0ec20bb117a33501fc6352ef218b1505b38e779554876a71 <span class="token punctuation">\</span>
    --control-plane

<span class="token comment"># 加入工作节点</span>
kubeadm <span class="token function">join</span> <span class="token number">192.168</span>.126.10:6443 <span class="token parameter variable">--token</span> mhls2v.xqoxslpkzj89l9bc     --discovery-token-ca-cert-hash sha256:7207de86a81efadf0ec20bb117a33501fc6352ef218b1505b38e779554876a71 <span class="token punctuation">\</span>
    --control-plane
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">2021-04-07: </span> <span class="time">9/12/2022, 9:32:20 PM</span></div></footer> <!----> <!----></main> <!----> <div class="comments-wrapper" data-v-4698c43e><!----></div></div></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-44bd5a18 data-v-44bd5a18><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-44bd5a18><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-44bd5a18></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-44bd5a18></path></svg></div><!----><div></div><!----><div class="reco-bgm-panel" data-v-b1d3339e><audio id="bgm" src="https://music.163.com/song/media/outer/url?id=1847975477" data-v-b1d3339e></audio> <div class="reco-float-box" style="bottom:200px;z-index:999999;display:none;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><img src="http://p2.music.126.net/jDTEtAnZiDvfq5iBpLQBRA==/109951166171265193.jpg" data-v-b1d3339e></div> <div class="reco-bgm-box" style="left:10px;bottom:10px;z-index:999999;" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="reco-bgm-cover" style="background-image:url(http://p2.music.126.net/jDTEtAnZiDvfq5iBpLQBRA==/109951166171265193.jpg);" data-v-b1d3339e><div class="mini-operation" style="display:none;" data-v-b1d3339e><i class="reco-bgm reco-bgm-pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play" style="display:none;" data-v-b1d3339e></i></div> <div class="falut-message" style="display:none;" data-v-b1d3339e>
          播放失败
        </div></div> <div class="reco-bgm-info" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-music music" data-v-b1d3339e></i>目及皆是你</div> <div class="info-box" data-v-b1d3339e><i class="reco-bgm reco-bgm-artist" data-v-b1d3339e></i>小蓝背心</div> <div class="reco-bgm-progress" data-v-b1d3339e><div class="progress-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div> <div class="reco-bgm-operation" data-v-b1d3339e><i class="reco-bgm reco-bgm-last last" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-pause pause" style="display:none;" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-play play" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-next next" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-volume1 volume" data-v-b1d3339e></i> <i class="reco-bgm reco-bgm-mute mute" style="display:none;" data-v-b1d3339e></i> <div class="volume-bar" data-v-b1d3339e><div class="bar" data-v-b1d3339e></div></div></div></div> <div class="reco-bgm-left-box" data-v-b1d3339e data-v-41bcba48 data-v-b1d3339e><i class="reco-bgm reco-bgm-left" data-v-b1d3339e></i></div></div></div><!----></div></div>
    <script src="/assets/js/app.d3fe0630.js" defer></script><script src="/assets/js/4.71650b81.js" defer></script><script src="/assets/js/1.2e0a1352.js" defer></script><script src="/assets/js/28.313b2b0d.js" defer></script><script src="/assets/js/10.4e913a6c.js" defer></script>
  </body>
</html>
